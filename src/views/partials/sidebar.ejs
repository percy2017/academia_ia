<!-- Sidebar Offcanvas -->
<div class="offcanvas offcanvas-start bg-light sidebar" tabindex="-1" id="sidebarOffcanvas" aria-labelledby="sidebarOffcanvasLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="sidebarOffcanvasLabel">Menú Principal</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body d-flex flex-column">
    <div class="flex-grow-1 pt-3">
      <ul class="nav flex-column">
        <% if (locals.user && locals.user.role === 'ADMIN') { %>
          <!-- Menú de Admin (Móvil) -->
          <li class="nav-item">
            <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath === '/') ? 'active' : '' %>" href="/">Dashboard</a>
          </li>
          <li class="nav-item">
            <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/admin/courses')) ? 'active' : '' %>" href="/admin/courses">Admin Cursos</a>
          </li>
          <li class="nav-item">
            <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/admin/tags')) ? 'active' : '' %>" href="/admin/tags">Admin Tags</a>
          </li>
          <li class="nav-item">
            <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/admin/users')) ? 'active' : '' %>" href="/admin/users">Admin Usuarios</a>
          </li>
          <li class="nav-item">
            <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/admin/subscription-plans')) ? 'active' : '' %>" href="/admin/subscription-plans">Admin Planes</a>
          </li>
          <li class="nav-item">
            <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/admin/subscriptions')) ? 'active' : '' %>" href="/admin/subscriptions">Suscripciones</a>
          </li>
          <li class="nav-item">
            <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/admin/media')) ? 'active' : '' %>" href="/admin/media">Multimedia</a>
          </li>
        <% } else if (locals.user && locals.user.role === 'STUDENT') { %>
          <!-- Menú de Estudiante (Móvil) -->
          <li class="nav-item">
            <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath === '/') ? 'active' : '' %>" href="/">Catálogo de Cursos</a>
          </li>
          <li class="nav-item">
            <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/profile')) ? 'active' : '' %>" href="/profile">Mi Perfil</a>
          </li>
          <li class="nav-item">
            <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/subscription-plans')) ? 'active' : '' %>" href="/subscription-plans">Suscripción</a>
          </li>
        <% } %>
      </ul>
    </div>
    <hr>
    <!-- Theme Switcher -->
     <div class="dropdown px-3 pb-3"> <!-- Added pb-3 for some spacing at the bottom -->
      <a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle" id="dropdownUser2" data-bs-toggle="dropdown" aria-expanded="false">
        <svg class="bi me-2" width="16" height="16"><use xlink:href="#circle-half"/></svg>
        <strong>Tema</strong>
      </a>
      <ul class="dropdown-menu text-small shadow" aria-labelledby="dropdownUser2">
        <li><button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light">
          <svg class="bi me-2 opacity-50 theme-icon" width="1em" height="1em"><use href="#sun-fill"></use></svg>
          Claro
          <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
        </button></li>
        <li><button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark">
          <svg class="bi me-2 opacity-50 theme-icon" width="1em" height="1em"><use href="#moon-stars-fill"></use></svg>
          Oscuro
          <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
        </button></li>
        <li><button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto">
          <svg class="bi me-2 opacity-50 theme-icon" width="1em" height="1em"><use href="#circle-half"></use></svg>
          Automático
          <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
        </button></li>
      </ul>
    </div>
  </div>
</div>

<!-- Sidebar tradicional para pantallas md y mayores -->
<% if (typeof hideMainSidebar === 'undefined' || !hideMainSidebar) { %>
<nav id="sidebarMenu" class="col-md-3 col-lg-2 d-none d-md-block bg-light sidebar">
  <div class="position-sticky pt-3 sidebar-sticky">
    <ul class="nav flex-column">
      <% if (locals.user && locals.user.role === 'ADMIN') { %>
        <!-- Menú de Admin (Desktop) -->
        <li class="nav-item">
          <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath === '/') ? 'active' : '' %>" href="/">
            <span data-feather="home"></span> Catálogo
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/admin/courses')) ? 'active' : '' %>" href="/admin/courses">
            <span data-feather="archive"></span> Cursos
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/admin/tags')) ? 'active' : '' %>" href="/admin/tags">
            <span data-feather="tag"></span> Tags
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/admin/users')) ? 'active' : '' %>" href="/admin/users">
            <span data-feather="users"></span> Usuarios
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/admin/subscription-plans')) ? 'active' : '' %>" href="/admin/subscription-plans">
            <span data-feather="list"></span> Planes
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/admin/subscriptions')) ? 'active' : '' %>" href="/admin/subscriptions">
            <i class="bi bi-card-checklist"></i> Suscripciones
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/admin/media')) ? 'active' : '' %>" href="/admin/media">
            <span data-feather="image"></span> Multimedia
          </a>
        </li>
      <% } else if (locals.user && locals.user.role === 'STUDENT') { %>
        <!-- Menú de Estudiante (Desktop) -->
        <li class="nav-item">
          <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath === '/') ? 'active' : '' %>" href="/">
            <i class="bi bi-book-open"></i> Catálogo de Cursos
          </a>
        </li>
        <!-- <li class="nav-item">
          <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/profile')) ? 'active' : '' %>" href="/profile">
            <i class="bi bi-person-circle"></i> Mi Perfil
          </a>
        </li> -->
        <li class="nav-item">
          <a class="nav-link <%= (typeof currentPath !== 'undefined' && currentPath.startsWith('/subscription-plans')) ? 'active' : '' %>" href="/subscription-plans">
            <i class="bi bi-gem"></i> Suscripción
          </a>
        </li>
      <% } %>
    </ul>
    <hr>
    <!-- Theme Switcher -->
    <div class="dropdown px-3 pb-3"> <!-- Added pb-3 for some spacing at the bottom -->
      <a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle" id="dropdownUser2" data-bs-toggle="dropdown" aria-expanded="false">
        <svg class="bi me-2" width="16" height="16"><use xlink:href="#circle-half"/></svg>
        <strong>Tema</strong>
      </a>
      <ul class="dropdown-menu text-small shadow" aria-labelledby="dropdownUser2">
        <li><button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light">
          <svg class="bi me-2 opacity-50 theme-icon" width="1em" height="1em"><use href="#sun-fill"></use></svg>
          Claro
          <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
        </button></li>
        <li><button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark">
          <svg class="bi me-2 opacity-50 theme-icon" width="1em" height="1em"><use href="#moon-stars-fill"></use></svg>
          Oscuro
          <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
        </button></li>
        <li><button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto">
          <svg class="bi me-2 opacity-50 theme-icon" width="1em" height="1em"><use href="#circle-half"></use></svg>
          Automático
          <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
        </button></li>
      </ul>
    </div>
  </div>
</nav>
<% } %>
